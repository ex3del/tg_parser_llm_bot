# Новостной телеграмм бот

## Описание

Это автоматизированный бот для парсинга новостей с веб-сайтов, генерации кратких постов с помощью языковой модели (Ollama), и публикации их в Telegram-канал. Проект состоит из двух основных компонентов:
- **Парсер новостей**: Собирает статьи из RSS-лент, обрабатывает их и сохраняет в JSON-файл.
- **Telegram-бот**: Отправляет сгенерированные посты в указанный Telegram-канал по расписанию.

Проект использует Docker для контейнеризации и Ollama для генерации текстов. Он устойчив к сбоям сети, временным отключениям интернета и падениям контейнеров благодаря встроенным механизмам повторных попыток и политикам перезапуска.

---

## Возможности

- Парсинг новостей из RSS-лент (настраиваемый URL).
- Генерация кратких постов с использованием Ollama.
- Автоматическая отправка постов с изображениями в Telegram-канал.
- Устойчивость к сбоям сети и контейнеров.
- Настраиваемые интервалы парсинга и отправки сообщений.

---

## Требования

- **Docker** и **Docker Compose** для запуска контейнеров.
- **NVIDIA GPU** 
- **Telegram Bot Token** (получите у [@BotFather](https://t.me/BotFather)).
- Доступ к интернету для парсинга RSS и работы Telegram API.

---

## Установка

1. **Клонируйте репозиторий**:

2. **Настройте переменные**:
   ```
   BOT_TOKEN=your_bot_token_here
   CHANNEL_ID=@your_channel
   RSS_URL=https://<your_website>.ru/news/rss  # Укажите нужный RSS-URL
   ```

3. **Создайте структуру проекта**:
   Убедитесь, что у вас есть следующие файлы:
   - `src/news_parser.py` — скрипт парсера.
   - `src/tg_bot_simplified.py` — скрипт Telegram-бота.
   - `build/ollama/Dockerfile` — Dockerfile для Ollama.
   - `build/bot/Dockerfile` — Dockerfile для бота.
   - `docker-compose.yml` — конфигурация Docker Compose.

4. **Соберите и запустите контейнеры**:
   ```bash
   docker-compose up --build -d
   ```

   Это создаст два контейнера:
   - `ollama-server`: Сервер Ollama.
   - `llm_bot`: Telegram-бот и парсер.

---

## Использование

- **Запуск**: После выполнения `docker-compose up --build` бот автоматически начнет работать:
  - Парсер проверяет RSS каждые 20 минут (настраивается в `tg_bot_simplified.py`).
  - Бот отправляет сообщения в Telegram-канал каждые 30 минут (настраивается в `tg_bot_simplified.py`).
- **Остановка**: Для остановки используйте:
  ```bash
  docker-compose down
  ```
- **Логи**: Просматривайте логи контейнера `llm_bot` для отладки:
  ```bash
  docker logs llm_bot
  ```

---

## Структура проекта

```
tg_parser_llm_bot/
├── src/
│   ├── 3dnews_parser.py    # Парсер новостей и генерация постов
│   └── tg_bot_simplified.py         # Telegram-бот и планировщик
├── data/
│   └── articles.json     # Хранилище статей 
├── build/
│   ├── ollama/
│   │   └── Dockerfile     # Dockerfile для Ollama
│   └── bot/
│       └── Dockerfile     # Dockerfile для бота
├── docker-compose.yaml     # Конфигурация Docker Compose         
├── requirements.txt       # Зависимости Python
├── .gitignore 
└── README.md              # Этот файл
```

